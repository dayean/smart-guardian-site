<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>ì•„ì´ ì¸ë„ ì„œëª…</title>
  <script src="https://cdn.jsdelivr.net/npm/signature_pad@4.1.6/dist/signature_pad.umd.min.js"></script>
</head>
<body>
  <h2>ğŸ“ ì•„ì´ ì¸ë„ ì„œëª…</h2>
  <form method="POST" onsubmit="return prepareSignature()">
    ë³´í˜¸ì ì„ íƒ:
    <select name="name">
      {% for g in guardians %}
        <option value="{{ g.name }}">{{ g.name }}</option>
      {% endfor %}
    </select><br><br>

    ì„œëª…:<br>
    <canvas id="signature-canvas" width="300" height="150" style="border:1px solid #000;"></canvas><br>
    <button type="button" onclick="signaturePad.clear()">ì§€ìš°ê¸°</button><br><br>
    <input type="hidden" name="signature" id="signature-data">
    <button type="submit">ì¸ë„ ì™„ë£Œ</button>
  </form>

  <script>
  const canvas = document.getElementById('signature-canvas');
  const signaturePad = new SignaturePad(canvas);

  function prepareSignature() {
    if (signaturePad.isEmpty()) {
      alert('ì„œëª…ì„ ì‘ì„±í•´ì£¼ì„¸ìš”.');
      return false;
    }

    // ë°°ê²½ í°ìƒ‰ìœ¼ë¡œ ì„¤ì •ëœ ìƒˆ ì´ë¯¸ì§€ ìƒì„±
    const tempCanvas = document.createElement('canvas');
    tempCanvas.width = canvas.width;
    tempCanvas.height = canvas.height;
    const ctx = tempCanvas.getContext('2d');

    ctx.fillStyle = "#FFFFFF";      // ë°°ê²½ í°ìƒ‰
    ctx.fillRect(0, 0, tempCanvas.width, tempCanvas.height);
    ctx.drawImage(canvas, 0, 0);    // ì›ë³¸ ì„œëª… ë®ì–´ì“°ê¸°

    document.getElementById('signature-data').value = tempCanvas.toDataURL();
    return true;
  }
</script>
</body>
</html>
